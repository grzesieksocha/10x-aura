---
description: E2E testing with Playwright
globs:
alwaysApply: false
---

## TESTING

### Guidelines for E2E

#### PLAYWRIGHT

- Initialize configuration only with Chromium/Desktop Chrome browser
- Use browser contexts for isolating test environments
- Implement the Page Object Model for maintainable tests in ./e2e/page-objects
- Use `data-testid` attributes when introducing resilient test-oriented selectors
- When following `data-testid` convention, locate elements by `await page.getByTestId('selectorName')`
- Leverage API testing for backend validation
- Implement visual comparison with expect(page).toHaveScreenshot()
- Use the codegen tool for test recording
- Leverage trace viewer for debugging test failures
- Implement test hooks for setup and teardown
- Use expect assertions with specific matchers
- Leverage parallel execution for faster test runs
- Follow 'Arrange', 'Act', 'Assert' approach to test structure for simplicity and readability.

#### DATABASE CLEANUP

- **ALWAYS** import test and expect from `./fixtures` instead of `@playwright/test`
- Database is automatically cleaned before each test using custom fixtures
- Test user data (accounts, transactions, categories, budgets) is removed before each test
- Worker-scoped cleanup runs after all tests complete to ensure clean state
- Use `createTestAccount()` helper from `./utils/database` for consistent test data setup
- Never assume data persists between tests - each test starts with clean database
- Test environment uses separate Supabase instance configured in `.env.test`
